# 매크로 자동화 프로그램 사용자 매뉴얼

## 1. 개요 (Overview)
본 프로그램은 이미지 인식과 하드웨어 제어 기술을 결합하여 반복적인 PC 작업을 자동화하는 매크로 제작 도구입니다. 복잡한 코딩 없이 UI 기반의 '티칭 에디터'를 통해 누구나 쉽게 시나리오를 작성하고 실행할 수 있습니다.

## 2. 기술적 구조 (Technical Architecture)
이 프로그램은 최신 Microsoft 기술 스택을 기반으로 제작되었습니다.

*   **프레임워크**: .NET 9.0 (WPF) - 고성능 데스크톱 애플리케이션
*   **아키텍처**: MVVM (ReactiveUI) - 반응형 프로그래밍 패턴 적용
*   **이미지 처리**: OpenCvSharp4 - 템플릿 매칭 알고리즘 (Template Matching)
*   **입력 제어**: Windows API (user32.dll) - 마우스/키보드 하드웨어 시뮬레이션
*   **데이터**: JSON 포맷을 이용한 레시피(매크로 스크립트) 저장

## 3. 주요 기능 (Key Features)

### 3.1. 스마트 인식 (Detection)
*   **이미지 매칭**: 화면상의 특정 이미지를 찾아 위치를 파악합니다.
*   **변화 감지 (Gray Scale)**: 화면의 특정 영역 변화를 감지하여 동작 시점을 판단합니다.
*   **ROI (관심 영역)**: 전체 화면이 아닌 특정 영역만 검색하여 속도와 정확도를 높입니다.

### 3.2. 정밀 제어 (Control)
*   **마우스 제어**: 클릭(좌/우/더블), 부드러운 이동(Smooth Move)으로 매크로 탐지를 회피합니다.
*   **키보드 제어**: 모든 키 입력 및 조합 키를 지원합니다.
*   **창(Window) 제어**: 실행 중인 프로그램이나 창 제목을 찾아 최대화, 최소화, 복원합니다.

### 3.3. 논리 흐름 제어 (Flow Logic)
*   **조건부 실행**: 이미지 발견 시 실행, 실패 시 재시도 또는 다른 스텝으로 이동.
*   **변수 시스템**: 값을 저장하고 비교하여 복잡한 분기 처리가 가능합니다.
*   **루프 및 점프**: 반복 횟수 설정 및 특정 스텝으로의 점프(Jump)를 지원합니다.

### 3.4. 사용자 편의성
*   **티칭 에디터**: 직관적인 한글 UI로 스텝을 추가, 수정, 삭제, 복사, 순서 변경이 가능합니다.
*   **실시간 모니터링**: 대시보드를 통해 현재 실행 중인 단계와 로그를 확인할 수 있습니다.
*   **단축키**: `F5`(시작), `F6`(중지) 키로 언제든지 제어가 가능합니다.

---

## 4. 사용 방법 - 티칭 에디터 (Guide)

티칭 에디터는 매크로의 각 '단계(Step)'를 설정하는 곳입니다. 각 단계는 **3단 구조**로 이루어져 있습니다.

### 4.1. 단계의 구조
1.  **시작 조건 (Pre-Condition)**: 이 단계를 실행하기 위한 전제 조건입니다. (예: 이미지가 보이면...)
2.  **동작 (Action)**: 조건이 만족되었을 때 수행할 행동입니다. (예: 마우스 클릭...)
3.  **완료 확인 (Post-Condition)**: 동작 후 성공 여부를 판단합니다. (예: 화면이 바뀌었는지 확인...)

### 4.2. 주요 기능 사용법

#### 이미지 매칭 설정
1.  조건 유형에서 **'Image Match'**를 선택합니다.
2.  **[파일 선택]**으로 기존 이미지를 불러오거나, **[화면 캡처]**로 즉시 잘라낼 수 있습니다.
3.  **[영역 선택]**을 눌러 화면의 특정 부분만 검사하도록(ROI) 설정하면 더 빠릅니다.

#### 마우스 클릭 설정
1.  동작 유형에서 **'Mouse Click'**을 선택합니다.
2.  **[현재위치]** 버튼을 누르고 원하는 곳을 클릭하면 좌표가 자동 입력됩니다.
3.  **'찾은 좌표 사용'**을 체크하면, 이전 조건에서 발견한 이미지의 위치를 클릭합니다.

#### 창 제어 (Window Control)
1.  동작 유형에서 **'Window Control'**을 선택합니다.
2.  **검색 기준**을 'Process Name'(프로세스 이름) 또는 'Window Title'(창 제목) 중 선택합니다.
3.  **[⟳] (새로고침)** 버튼을 눌러 현재 실행 중인 목록을 불러온 뒤 선택합니다.
4.  **상태**에서 최대화(Maximize), 최소화(Minimize), 복원(Restore)을 선택합니다.

#### 흐름 제어 및 편집
*   **순서 변경**: 목록의 ▲, ▼ 버튼을 눌러 실행 순서를 바꿀 수 있습니다.
*   **복사/붙여넣기**: 하단의 [복사], [붙여넣기] 버튼으로 스텝을 복제할 수 있습니다.
*   **실패 시 이동**: 조건이나 동작 실패 시 점프할 스텝을 지정하여 에러 처리를 할 수 있습니다.

---

## 5. 실행 및 단축키

1.  **Dashboard (대시보드)** 탭으로 이동합니다.
2.  작성한 레시피가 로드되었는지 확인합니다.
3.  **`F5`** 키를 누르면 매크로가 실행됩니다.
4.  실행 중 **`F6`** 키를 누르면 즉시 중단됩니다.
