# 매크로 프로그램 사용 설명서 (Teaching Manual)

이 문서는 매크로 자동화 프로그램의 핵심인 **티칭(Teaching)** 페이지의 사용 방법을 설명합니다.

---

## 1. 화면 구성 (Interface Overview)

티칭 화면은 크게 세 영역으로 나뉩니다.

1.  **좌측 목록 (Sequence Tree)**:
    *   **그룹(Folder)**과 **스텝(Step)**의 계층 구조를 보여줍니다.
    *   항목을 선택하여 우측에서 설정을 편집할 수 있습니다.
    *   `▶` 버튼: 해당 스텝 하나만 즉시 테스트 실행합니다.
    *   `▲ / ▼` 버튼: 항목의 순서를 변경합니다.
    *   `Check Box`: 체크 해제 시 해당 스텝은 실행 시 무시(Skip)됩니다.

2.  **우측 설정 패널 (Settings Panel)**:
    *   **그룹 선택 시**: 대상 윈도우(Target Window) 및 좌표계 설정을 관리합니다.
    *   **스텝 선택 시**: [시작 조건] -> [동작] -> [완료 확인]의 3단계 로직을 설정합니다.

3.  **하단 명령 바 (Command Bar)**:
    *   **그룹 추가/삭제/복사**: 시퀀스 그룹을 관리합니다.
    *   **스텝 추가/삭제**: 선택된 그룹 내에 스텝을 추가합니다.
    *   **복사/붙여넣기**: 선택된 스텝을 복사합니다.
    *   **저장**: 작성된 레시피를 파일로 저장합니다.

---

## 2. 레시피 작성 기초 (Workflow)

자동화 스크립트(레시피)는 **그룹(Group)**과 그 아래의 **스텝(Step)**들로 구성됩니다.

### 1단계: 그룹 생성 및 타겟 설정
가장 먼저 **[그룹 추가]** 버튼을 눌러 그룹을 생성합니다. 그룹은 단순한 폴더 역할을 넘어, 하위 스텝들이 동작할 **대상 프로그램**을 정의합니다.

*   **좌표 모드 (Coordinate Mode)**:
    *   `Global`: 모니터 전체 화면 기준 절대 좌표를 사용합니다.
    *   `WindowRelative`: 특정 프로그램 창 기준 상대 좌표를 사용합니다. (추천)
*   **대상 이름 (Target Name)**: 제어할 프로그램의 **프로세스 이름** 또는 **창 제목(Title)**을 입력합니다.
    *   *팁: 돋보기(⟳) 버튼을 누르면 현재 실행 중인 프로세스 목록을 불러옵니다.*
    *   *검색 방식: 정확히 일치하는 이름을 우선 찾고, 없으면 해당 단어를 포함한 창을 찾습니다.*

### 2단계: 스텝 추가 및 3단계 로직 구성
그룹을 선택한 상태에서 **[스텝 추가]**를 누릅니다. 하나의 스텝은 다음 3단계 파이프라인으로 실행됩니다.

#### (1) 시작 조건 (Pre-Condition)
동작을 수행하기 전에 만족해야 할 조건입니다.
*   **Image Match**: 화면에 특정 이미지가 나타났는지 확인합니다.
    *   `화면 캡처`: 현재 화면을 캡처하여 찾을 이미지를 잘라냅니다.
    *   `파일 선택`: 기존 이미지 파일을 불러옵니다.
    *   `영역 지정 (ROI)`: 전체 화면 대신 특정 영역에서만 검색하여 속도를 높입니다.
    *   `Test Match`: 현재 화면에서 이미지가 잘 찾아지는지 즉시 테스트합니다.
*   **Delay**: 일정 시간 대기합니다.
*   **Variable Compare**: 변수 값이 특정 조건인지 확인합니다.

#### (2) 동작 (Action)
조건이 만족되었을 때 수행할 실제 동작입니다.
*   **Mouse Click**: 마우스를 이동하여 클릭합니다.
    *   `찾은 좌표 사용`: Pre-Condition에서 이미지를 찾은 위치를 클릭합니다. (매우 유용)
    *   `현재위치`: 버튼을 누르고 화면의 원하는 곳을 클릭하면 좌표가 자동 입력됩니다.
*   **Key Press**: 키보드 입력을 보냅니다.
*   **Window Control**: 창을 최대화/최소화/복원하거나 활성화합니다.
*   **Variable Set**: 변수에 값을 저장하거나 연산(더하기/빼기)합니다.

#### (3) 완료 확인 (Post-Condition)
동작 후, 결과가 제대로 수행되었는지 검증합니다. (설정 방식은 Pre-Condition과 동일)

---

## 3. 핵심 편의 기능

### 💡 스마트 그룹 복사 (Duplicate Group)
비슷한 패턴의 작업을 반복해서 만들어야 할 때 사용합니다.
1.  복사할 그룹을 선택합니다.
2.  하단의 **[그룹 복사]** 버튼을 클릭합니다.
3.  그룹이 통째로 복제되며, 내부의 **점프(성공/실패 시 이동) 연결이 깨지지 않고 자동으로 새 그룹 내의 스텝들을 가리키도록 보정**됩니다.

### 🎯 윈도우 상대 좌표 (Window Relative)
창의 위치나 크기가 바뀌어도 매크로가 정상 동작하도록 돕는 기능입니다.
*   그룹 설정에서 `WindowRelative`를 선택하고 대상을 지정하면, 모든 하위 스텝의 좌표와 이미지 검색 영역(ROI)이 **창의 왼쪽 위 모서리를 기준(0,0)**으로 자동 계산됩니다.
*   창 크기가 변하더라도 비율(Scale)에 맞춰 자동으로 좌표를 보정합니다.

### 🔀 흐름 제어 (Flow Control)
각 조건(Pre/Action/Post)마다 **실패 시 이동(Fail Jump)**을 설정할 수 있습니다.
*   `(Next Step)`: 실패를 무시하고 다음으로 넘어갑니다.
*   `(Stop Execution)`: 매크로를 즉시 중단합니다.
*   `특정 스텝/그룹`: 지정한 위치로 점프합니다. (반복문이나 에러 처리 루틴 구현 시 사용)
*   **성공 시 이동**: 스텝이 모두 성공했을 때 어디로 갈지 설정할 수 있습니다. (기본값: 다음 단계)

---

## 4. 실행 및 테스트

1.  **단일 실행**: 트리 목록에서 각 스텝 우측의 `▶` 버튼을 누르면 해당 스텝만 실행해 볼 수 있습니다.
2.  **전체 실행**: [Dashboard] 탭으로 이동하여 `▶ 시작` 버튼을 누르면 전체 시퀀스가 실행됩니다.
3.  **중지**: 실행 중 언제든지 `■ 정지` 버튼을 누르면, 딜레이나 이미지 검색 중이라도 즉시 중단됩니다.